---
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

interface Props {
    title: string;
    description?: string;
}

const { title, description = "A personal tech blog." } = Astro.props;
---

<!doctype html>
<html lang="en" class="h-full antialiased">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content={description} />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>

        <!-- Font Preloads (Critical Only) -->
        <link
            rel="preload"
            href="/fonts/inter-latin.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <link
            rel="preload"
            href="/fonts/playfair-latin.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />
        <script is:inline>
            // On page load or when changing themes, best to add inline in `head` to avoid FOUC
            if (
                localStorage.getItem("color-theme") === "dark" ||
                (!("color-theme" in localStorage) &&
                    window.matchMedia("(prefers-color-scheme: dark)").matches)
            ) {
                document.documentElement.classList.add("dark");
            } else {
                document.documentElement.classList.remove("dark");
            }
        </script>
        <style is:global>
            @font-face {
                font-family: "Inter";
                src: url("/fonts/inter-latin.woff2") format("woff2");
                font-weight: 400 700;
                font-style: normal;
                font-display: swap;
            }
            @font-face {
                font-family: "Playfair Display";
                src: url("/fonts/playfair-latin.woff2") format("woff2");
                font-weight: 900;
                font-style: normal;
                font-display: swap;
            }
            @font-face {
                font-family: "Playfair Display";
                src: url("/fonts/playfair-italic-latin.woff2") format("woff2");
                font-weight: 900;
                font-style: italic;
                font-display: swap;
            }
            @font-face {
                font-family: "Space Mono";
                src: url("/fonts/space-mono-latin.woff2") format("woff2");
                font-weight: 400;
                font-style: normal;
                font-display: swap;
            }
            @font-face {
                font-family: "Space Mono";
                src: url("/fonts/space-mono-bold-latin.woff2") format("woff2");
                font-weight: 700;
                font-style: normal;
                font-display: swap;
            }

            :root {
                --ink: #000000;
                --paper: #ffffff;
            }
            .dark {
                --ink: #ffffff;
                --paper: #0a0a0a;
            }

            body {
                background-color: var(--paper);
                /* High-performance noise using conic gradient */
                background-image:
                    radial-gradient(
                        circle at 50% 50%,
                        rgba(0, 0, 0, 0.02) 0%,
                        transparent 100%
                    ),
                    repeating-conic-gradient(#000 0 0.0001%, #fff 0 0.0002%) 50%
                        50% / 100px 100px;
                background-repeat: repeat;
                color: var(--ink);
                font-family: "Inter", system-ui, sans-serif;
                position: relative;
            }

            .dark body {
                background-image:
                    radial-gradient(
                        circle at 50% 50%,
                        rgba(255, 255, 255, 0.02) 0%,
                        transparent 100%
                    ),
                    repeating-conic-gradient(#fff 0 0.0001%, #000 0 0.0002%) 50%
                        50% / 100px 100px;
            }

            /* Grain Overlay - Fallback to simple noise if conic is weird, but conic is usually fine */
            body::after {
                content: "";
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 9999;
                opacity: 0.02;
                background: var(--ink);
                mix-blend-mode: overlay;
                display: block;
            }

            .brutalist-border {
                border: 3px solid var(--ink);
                box-shadow: 6px 6px 0px 0px var(--ink);
                transition: all 0.2s ease;
            }

            .brutalist-border:hover {
                transform: translate(-2px, -2px);
                box-shadow: 8px 8px 0px 0px var(--ink);
            }

            .brutalist-border:active {
                transform: translate(2px, 2px);
                box-shadow: 2px 2px 0px 0px var(--ink);
            }

            h1,
            h2,
            h3,
            h4 {
                font-family: "Playfair Display", serif;
                text-transform: uppercase;
                letter-spacing: -0.02em;
            }

            .mono {
                font-family: "Space Mono", monospace;
            }
        </style>
    </head>
    <body
        class="flex flex-col min-h-screen bg-white dark:bg-neutral-950 text-black dark:text-white transition-colors duration-200"
    >
        <a
            href="#main-content"
            class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 z-50 bg-black text-white dark:bg-white dark:text-black px-4 py-2 brutalist-border"
        >
            Skip to content
        </a>
        <Header />
        <main
            id="main-content"
            class="flex-grow w-full"
            aria-label="Main Content"
        >
            <slot />
        </main>
        <Footer />
    </body>
</html>
