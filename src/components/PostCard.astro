---
import type { CollectionEntry } from "astro:content";

import { Image } from "astro:assets";

interface Props {
  post: CollectionEntry<"posts">;
}

const { post } = Astro.props;
const { title, description, date, coverImage, tags } = post.data;

const formattedDate = date.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});
---

<article
  class="flex flex-col h-full bg-white dark:bg-black brutalist-border group hover:bg-black hover:text-white dark:hover:bg-white dark:hover:text-black transition-all overflow-hidden"
>
  {
    coverImage && (
      <a
        href={`/blog/${post.slug}`}
        class="flex-shrink-0 overflow-hidden block relative h-56 border-b-4 border-black dark:border-white"
        aria-hidden="true"
        tabindex="-1"
      >
        <Image
          class="h-full w-full object-cover grayscale brightness-90 group-hover:grayscale-0 group-hover:brightness-100 transition-all duration-500 scale-105 group-hover:scale-100"
          src={coverImage}
          alt={title}
          width={600}
          height={400}
          widths={[300, 600]}
          sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw"
          format="webp"
          loading="lazy"
          decoding="async"
        />
      </a>
    )
  }
  <div class="flex-1 p-8 flex flex-col">
    <div class="flex-1">
      <div class="flex flex-wrap gap-2 mb-4">
        {
          tags.map((tag) => (
            <span class="text-[10px] font-black uppercase tracking-tighter px-2 py-0.5 border-2 border-black dark:border-white group-hover:border-white dark:group-hover:border-black mono">
              {tag}
            </span>
          ))
        }
      </div>
      <a href={`/blog/${post.slug}`} class="block">
        <h2
          class="text-3xl font-black uppercase leading-none mb-4 font-serif italic"
        >
          {title}
        </h2>
        <p
          class="mt-3 text-sm font-medium opacity-80 line-clamp-3 leading-relaxed"
        >
          {description}
        </p>
      </a>
    </div>
    <div
      class="mt-8 flex items-center justify-between border-t-2 border-black/10 dark:border-white/10 group-hover:border-white/20 dark:group-hover:border-black/20 pt-6"
    >
      <time
        datetime={date.toISOString()}
        class="text-[10px] font-bold uppercase tracking-widest mono"
      >
        {formattedDate}
      </time>
      <a
        href={`/blog/${post.slug}`}
        class="text-[10px] font-black uppercase tracking-widest border-b-2 border-black dark:border-white group-hover:border-white dark:group-hover:border-black mono"
        aria-label={`Read Entry: ${title}`}
      >
        Read Entry &rarr;
      </a>
    </div>
  </div>
</article>
